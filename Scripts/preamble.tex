% !TEX TS-program = xelatex
% !TEX encoding = UTF-8 Unicode

% Language and font management
\usepackage{babel}  % Multi-language support
\usepackage[utf8]{inputenc}   % sets document encoding to utf8
\usepackage{microtype}  % For better typography
\usepackage{ragged2e} % justifying text
\usepackage{tikz}

% Math and symbols
\usepackage{fontspec}
\usepackage{unicode-math}
\usepackage{lmodern}
\usepackage{amsmath}  % For math support
\usepackage{amssymb}  % For extra math symbols
\usepackage{gensymb} %degree symbol

%% document formatting
\usepackage{libertine}
\usepackage{array}
\usepackage{multirow}
\usepackage[table]{xcolor}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage{makecell}
\usepackage[hang]{footmisc}


% Page layout and geometry
\usepackage{geometry}
\geometry{a4paper, left=1in, right=1in, top=1in, bottom=1in, headheight=0.5in, footskip=0.5in}  % Set page margins

% Line spacing and titles
\usepackage{setspace}
\onehalfspacing  % Use one-and-a-half line spacing
\usepackage{titlesec}  % Title formatting
\titleformat{\section}[block]{\Large\bfseries\centering}{\thesection}{1em}{}

% Header and footer setup
\usepackage{fancyhdr}
\pagestyle{fancy}
% Left/Right header (empty)
\fancyhead[L,R]{}  
% Left/Right header (empty)
\fancyfoot[L,R]{}  
% center of header
\fancyhead[CO,CE]{Rmarkdown Template File}
% center of footer
\fancyfoot[CO,CE]{\thepage}

% Hyperlink and references setup
\definecolor{urbnblue}{HTML}{1696D2}    % Defines the blue color
\usepackage{hyperref}  % Hyperlinks and references
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={Dellinger, Robert J.},
            pdftitle={Rmarkdown Template File},
            colorlinks=true,
            citecolor=blue,
            urlcolor=blue,
            linkcolor=magenta,
            pdfborder={0 0 0}}

% Listings for code formatting (R code)
\usepackage{listings}
\usepackage{xcolor}  % For color customization
\lstdefinestyle{RStyle}{
  language=R,                         % Set the language to R
  basicstyle=\small\ttfamily,          % Use small size and monospaced font
  backgroundcolor=\color{white},      % Set background color
  showspaces=false,                   % Do not display spaces with underscores
  showstringspaces=false,             % Do not underline spaces in strings
  showtabs=false,                     % Do not display tabs with arrows
  tabsize=2,                          % Set tab size to 2 spaces
  breaklines=true,                    % Enable line breaking
  breakatwhitespace=true,            % Break lines at whitespace
  columns=fullflexible,
  escapeinside = ||,
  breakindent=0pt,
  commentstyle=\color{urbnblue},          % Style for comments
  keywordstyle=\color{black},          % Style for keywords
  stringstyle=\color{black}           % Style for strings
}
\lstset{style=RStyle}

% Fancy verbatim (improve code formatting)
\usepackage{fancyvrb}
\usepackage{fvextra}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{
    breaklines=true,
    breakanywhere=true,
    commandchars=\\\{\},
    fontsize=\small
}

% Adding line breaks to hash environment
\usepackage{seqsplit}
\renewcommand{\texttt}[1]{{\ttfamily\seqsplit{#1}}}
\lstset{xleftmargin=15pt, xrightmargin=15pt}  % Adjust code block margins

% Tables and long tables
\usepackage{longtable,booktabs}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
\setlength{\emergencystretch}{3em}  % prevent overfull lines

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

\setlength{\emergencystretch}{5em}  % Increase stretch

