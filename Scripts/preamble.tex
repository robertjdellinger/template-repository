% !TEX TS-program = xelatex
% !TEX encoding = UTF-8 Unicode

% Language, font, and typography management
\usepackage{babel, fontspec, lmodern, unicode-math, microtype}
\usepackage{amsmath, amssymb, gensymb, xcolor}

% Page layout and formatting
\geometry{a4paper, margin=1in, headheight=0.5in, footskip=0.5in}
\usepackage{setspace}  % For line spacing
\setlength{\parskip}{6pt plus 2pt minus 1pt}  % Adjust paragraph spacing
\setstretch{1.5}  % Adjust line spacing
\usepackage{titlesec}  % Title formatting
\titleformat{\section}[block]{\Large\bfseries\centering}{\thesection}{1em}{}

% Header and footer setup
\usepackage{fancyhdr}
\pagestyle{fancy}
% Left/Right header (empty)
\fancyhead[L,R]{}  
% Left/Right header (empty)
\fancyfoot[L,R]{}  
% center of header
\fancyhead[C]{Rmarkdown Template File}
% center of footer
\fancyfoot[C]{\thepage}


\definecolor{urbnblue}{HTML}{1696D2}    % Defines the blue color


% Listings for code formatting (R code)
\usepackage{listings}
\usepackage{xcolor}  % For color customization
\lstdefinestyle{RStyle}{
  language=R,                         % Set the language to R
  backgroundcolor=\color{gray!10},  % Set background color
  basicstyle=\fontsize{8}{10}\selectfont\ttfamily,  % Custom font size between tiny and small
  backgroundcolor=\color{white},      % Set background color
  showspaces=false,                   % Do not display spaces with underscores
  showstringspaces=false,             % Do not underline spaces in strings
  showtabs=false,                     % Do not display tabs with arrows
  tabsize=2,                          % Set tab size to 2 spaces
  breaklines=true,                    % Enable line breaking
  breakautoindent=true,
  columns=fullflexible,
  escapeinside = ||,
  commentstyle=\color{urbnblue},          % Style for comments
  keywordstyle=\color{black},          % Style for keywords
  stringstyle=\color{black}           % Style for strings
}

\lstset{style=RStyle}

% Fancy verbatim (improve code formatting)
\usepackage{fancyvrb}
\usepackage{fvextra}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{
    breaklines=true,
    breakanywhere=true,
    commandchars=\\\{\},
    fontsize=\small
}

% Adding line breaks to hash environment
\lstset{xleftmargin=15pt, xrightmargin=15pt}  % Adjust code block margins

% Hyperlink and references setup
\usepackage{hyperref}  % Hyperlinks and references
\hypersetup{
  colorlinks=true,
  linkcolor=urbnblue,
  citecolor=urbnblue,
  urlcolor=urbnblue,
  pdfborder={0 0 0}
}

% Tables and long tables
\usepackage{longtable,booktabs}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
\setlength{\emergencystretch}{3em}  % prevent overfull lines

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

\setlength{\emergencystretch}{5em}  % Increase stretch

% Graphics
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}


