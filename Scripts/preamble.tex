% !TEX TS-program = xelatex
% !TEX encoding = UTF-8 Unicode

% === Language, Font, and Typography Management ===
\usepackage{babel, fontspec, lmodern, unicode-math, microtype}
\usepackage{amsmath, amssymb, gensymb, xcolor}

% === Page Layout and Formatting ===
\geometry{a4paper, left=1in, right=1in, top=1in, bottom=1in, headheight=0.5in, footskip=0.5in}
\usepackage{setspace}
\setlength{\parskip}{8pt plus 2pt minus 1pt} % Comfortable paragraph spacing
\setstretch{1.5}  % 1.5 line spacing

% === Section Title Formatting ===
\usepackage{titlesec}
\titleformat{\section}[block]{\Large\bfseries\centering}{\thesection}{1em}{}
\titleformat{\subsection}[runin]{\large\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection}[runin]{\normalsize\bfseries}{\thesubsubsection}{1em}{}
\titlespacing*{\section}{0pt}{12pt plus 4pt minus 2pt}{8pt plus 2pt minus 2pt}
\titlespacing*{\subsection}{0pt}{8pt plus 2pt minus 1pt}{6pt plus 1pt minus 1pt}
\titlespacing*{\subsubsection}{0pt}{6pt plus 1pt minus 1pt}{4pt plus 1pt minus 1pt}

% === Document Settings for Clarity ===
\setlength{\parindent}{0pt}  % No paragraph indentation
\setlength{\emergencystretch}{3em}  % Allow some stretch to avoid overfull lines

% === Header and Footer Setup ===
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhead[L,R]{}             % Clear left and right header
\fancyfoot[L,R]{}             % Clear left and right footer
\fancyhead[C]{Rmarkdown Template File}  % Centered header
\fancyfoot[C]{\thepage}       % Centered footer (page number)

\definecolor{urbnblue}{HTML}{1696D2}  % Define custom blue color

% === Listings for Code Formatting (R code) ===
\usepackage{listings}
\lstdefinestyle{RStyle}{
  language=R,                         % Set language to R
  backgroundcolor=\color{white},      % White background
  basicstyle=\fontsize{10}{11}\selectfont\ttfamily,  % Custom font size (between tiny and small)
  showspaces=false,                   % Do not mark spaces
  showstringspaces=false,             % Do not mark spaces in strings
  showtabs=false,                     % Do not mark tabs
  tabsize=2,                          % Tab size set to 2 spaces
  breaklines=true,                    % Automatic line breaking
  breakautoindent=true,               % Preserve indentation on line breaks
  columns=fullflexible,               % Use full flexible column width
  xleftmargin=15pt, xrightmargin=15pt, % Left and right margins for code blocks
  commentstyle=\color{urbnblue},      % Comment color
  keywordstyle=\color{black},         % Keyword color
  stringstyle=\color{gray}            % String color
}
\lstset{style=RStyle}

% === Fancy Verbatim (for enhanced verbatim text) ===
\usepackage{fancyvrb}
\usepackage{fvextra}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{
  breaklines=true,
  breakanywhere=true,
  commandchars=\\\{\},
  fontsize=\small
}

% === Hyperlink and References Setup ===
\usepackage{hyperref}
\hypersetup{
  colorlinks=true,
  linkcolor=urbnblue,
  citecolor=urbnblue,
  urlcolor=urbnblue,
  pdfborder={0 0 0}
}

% === Tables and Long Tables ===
\usepackage{longtable,booktabs}

% === Graphics and Figures ===
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth \linewidth \else \Gin@nat@width \fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight \textheight \else \Gin@nat@height \fi}
\makeatother
\setkeys{Gin}{width=\maxwidth, height=\maxheight, keepaspectratio}

% End of preamble.